###
# Define constants frequently used
###

import torch

import math

def get_default_device():
    if torch.cuda.is_available():
        return "cuda"
    # elif getattr(torch.backends, "mps", None) is not None and torch.backends.mps.is_available():
    #     return "mps"
    else:
        return "cpu"

    # return "cpu"

class Constants:
    def __init__(self):
        self._atom_num_upper = 200
        self.atom_valence = {"C": 4, "O": 2, "N": 3, "S": 2, "Cl": 1, "F": 1, "P": 5, "Si": 4, "H": 1}
        self.atom_mass = {"H": 10, "He": 40, "Li": 70, "Be": 90, "B": 108,
                        "C": 120, "N": 140, "O": 160, "F": 190, "Ne": 200,
                        "Na": 230, "Mg": 240, "Al": 270, "Si": 280, "P": 310,
                        "S": 320, "Cl": 355, "Ar": 400, "K": 390, "Ca": 400,
                        "Sc": 450, "Ti": 479, "V": 509, "Cr": 520, "Mn": 549,
                        "Fe": 558, "Co": 589, "Ni": 587, "Cu": 635, "Zn": 654,
                        "Ga": 697, "Ge": 726, "As": 749, "Se": 790, "Br": 800,
                        "Kr": 838, "Rb": 855, "Sr": 876, "Y": 889, "Zr": 912,
                        "Nb": 929, "Mo": 956, "Tc": 989, "Ru": 1010, "Rh": 1029,
                        "Pd": 1064, "Ag": 1079, "Cd": 1124, "In": 1148, "Sn": 1187,
                        "Sb": 1218, "Te": 1276, "I": 1270, "Xe": 1313, "Cs": 1329,
                        "Ba": 1273, "La": 1389, "Ce": 1401, "Pr": 1409, "Nd": 1442,
                        "Pm": 1469, "Sm": 1504, "Eu": 1520, "Gd": 1573, "Tb": 1589,
                        "Dy": 1625, "Ho": 1649, "Er": 1673, "Tm": 1689, "Yb": 1731,
                        "Lu": 1750, "Hf": 1785, "Ta": 1809, "W": 1838, "Re": 1862,
                        "Os": 1902, "Ir": 1922, "Pt": 1951, "Au": 1970, "Hg": 2006,
                        "Tl": 2044, "Pb": 2072, "Bi": 2090, "Po": 2090, "At": 2100,
                        "Rn": 2220, "Fr": 2230, "Ra": 2260, "Ac": 2270, "Th": 2320,
                        "Pa": 2310, "U": 2380, "Np": 2370, "Pu": 2441, "Am": 2431,
                        "Cm": 2471, "Bk": 2471, "Cf": 2511, "Es": 2521, "Fm": 2571,
                        "Md": 2581, "No": 2591, "Lr": 2601, "Rf": 2611, "Db": 2621,
                        "Sg": 2631, "Bh": 2621, "Hs": 2770, "Mt": 2780, "Ds": 2810,
                        "Rg": 2840, "Cn": 2880, "Nh": 2930, "Fl": 2980, "Mc": 2990,
                        "Lv": 3020, "Ts": 3100, "Og": 3140}
        self.atomic_number = {"H": 1, "He": 2, "Li": 3, "Be": 4, "B": 5, 
                        "C": 6, "N": 7, "O": 8, "F": 9, "Ne": 10,
                        "Na": 11, "Mg": 12, "Al": 13, "Si": 14, "P": 15,
                        "S": 16, "Cl": 17, "Ar": 18, "K": 19, "Ca": 20,
                        "Sc": 21, "Ti": 22, "V": 23, "Cr": 24, "Mn": 25,
                        "Fe": 26, "Co": 27, "Ni": 28, "Cu": 29, "Zn": 30,
                        "Ga": 31, "Ge": 32, "As": 33, "Se": 34, "Br": 35,
                        "Kr": 36, "Rb": 37, "Sr": 38, "Y": 39, "Zr": 40,
                        "Nb": 41, "Mo": 42, "Tc": 43, "Ru": 44, "Rh": 45,
                        "Pd": 46, "Ag": 47, "Cd": 48, "In": 49, "Sn": 50,
                        "Sb": 51, "Te": 52, "I": 53, "Xe": 54, "Cs": 55,
                        "Ba": 56, "La": 57, "Ce": 58, "Pr": 59, "Nd": 60,
                        "Pm": 61, "Sm": 62, "Eu": 63, "Gd": 64, "Tb": 65,
                        "Dy": 66, "Ho": 67, "Er": 68, "Tm": 69, "Yb": 70,
                        "Lu": 71, "Hf": 72, "Ta": 73, "W": 74, "Re": 75,
                        "Os": 76, "Ir": 77, "Pt": 78, "Au": 79, "Hg": 80,
                        "Tl": 81, "Pb": 82, "Bi": 83, "Po": 84, "At": 85,
                        "Rn": 86, "Fr": 87, "Ra": 88, "Ac": 89, "Th": 90,
                        "Pa": 91, "U": 92, "Np": 93, "Pu": 94, "Am": 95,
                        "Cm": 96, "Bk": 97, "Cf": 98, "Es": 99, "Fm": 100,
                        "Md": 101, "No": 102, "Lr": 103, "Rf": 104, "Db": 105,
                        "Sg": 106, "Bh": 107, "Hs": 108, "Mt": 109, "Ds": 110,
                        "Rg": 111, "Cn": 112, "Nh": 113, "Fl": 114, "Mc": 115,
                        "Lv": 116, "Ts": 117, "Og": 118, "*": 999}
        self.atom_electronegativity = {"H": 2.2, "He": 0, "Li": 1.0, "Be": 1.6, "B": 2.0, 
                        "C": 2.6, "N": 3.0, "O": 3.4, "F": 4.0, "Ne": 0,
                        "Na": 0.9, "Mg": 1.3, "Al": 1.6, "Si": 1.9, "P": 2.2,
                        "S": 2.6, "Cl": 3.2, "Ar": 0, "K": 0.8, "Ca": 1.0,
                        "Sc": 1.4, "Ti": 1.5, "V": 1.6, "Cr": 1.7, "Mn": 1.6,
                        "Fe": 1.8, "Co": 1.9, "Ni": 1.9, "Cu": 1.9, "Zn": 1.6,
                        "Ga": 1.8, "Ge": 2.0, "As": 2.2, "Se": 2.6, "Br": 3.0,
                        "Kr": 0, "Rb": 0.8, "Sr": 1.0, "Y": 1.2, "Zr": 1.3,
                        "Nb": 1.6, "Mo": 2.2, "Tc": 2.1, "Ru": 2.2, "Rh": 2.3,
                        "Pd": 2.2, "Ag": 1.9, "Cd": 1.7, "In": 1.8, "Sn": 2.0,
                        "Sb": 2.0, "Te": 2.1, "I": 2.7, "Xe": 2.6, "Cs": 0.8,
                        "Ba": 0.9, "La": 1.1, "Ce": 0, "Pr": 0, "Nd": 0,
                        "Pm": 0, "Sm": 0, "Eu": 0, "Gd": 0, "Tb": 0,
                        "Dy": 0, "Ho": 0, "Er": 0, "Tm": 0, "Yb": 0,
                        "Lu": 0, "Hf": 1.3, "Ta": 1.5, "W": 1.7, "Re": 1.9,
                        "Os": 2.2, "Ir": 2.2, "Pt": 2.2, "Au": 2.4, "Hg": 1.9,
                        "Tl": 1.8, "Pb": 1.8, "Bi": 1.9, "Po": 2.0, "At": 2.2,
                        "Rn": 0, "Fr": 0.7, "Ra": 0.9, "Ac": 1.1, "Th": 0,
                        "Pa": 0, "U": 0, "Np": 0, "Pu": 0, "Am": 0,
                        "Cm": 0, "Bk": 0, "Cf": 0, "Es": 0, "Fm": 0,
                        "Md": 0, "No": 0, "Lr": 0, "Rf": 0, "Db": 0,
                        "Sg": 0, "Bh": 0, "Hs": 0, "Mt": 0, "Ds": 0,
                        "Rg": 0, "Cn": 0, "Nh": 0, "Fl": 0, "Mc": 0,
                        "Lv": 0, "Ts": 0, "Og": 0, "*": 999}
        self.atom_ion_energy = {"H": 1.312, "He": 2.372, "Li": 0.520, "Be": 0.900, "B": 0.801, 
                        "C": 1.086, "N": 1.402, "O": 1.314, "F": 1.681, "Ne": 2.081,
                        "Na": 0.496, "Mg": 0.738, "Al": 0.578, "Si": 0.787, "P": 1.012,
                        "S": 1.000, "Cl": 1.251, "Ar": 1.520, "K": 0.419, "Ca": 0.590,
                        "Sc": 0.633, "Ti": 0.659, "V": 0.651, "Cr": 0.653, "Mn": 0.717,
                        "Fe": 0.762, "Co": 0.760, "Ni": 0.737, "Cu": 0.745, "Zn": 0.906,
                        "Ga": 0.579, "Ge": 0.762, "As": 0.944, "Se": 0.941, "Br": 1.140,
                        "Kr": 1.351, "Rb": 0.403, "Sr": 0.549, "Y": 0.600, "Zr": 0.640,
                        "Nb": 0.652, "Mo": 0.684, "Tc": 0.702, "Ru": 0.710, "Rh": 0.720,
                        "Pd": 0.804, "Ag": 0.731, "Cd": 0.868, "In": 0.558, "Sn": 0.709,
                        "Sb": 0.831, "Te": 0.889, "I": 1.008, "Xe": 1.170, "Cs": 0.376,
                        "Ba": 0.503, "La": 0.538, "Ce": 0, "Pr": 0, "Nd": 0,
                        "Pm": 0, "Sm": 0, "Eu": 0, "Gd": 0, "Tb": 0,
                        "Dy": 0, "Ho": 0, "Er": 0, "Tm": 0, "Yb": 0,
                        "Lu": 0, "Hf": 0.659, "Ta": 0.728, "W": 0.759, "Re": 0.756,
                        "Os": 0.814, "Ir": 0.865, "Pt": 0.864, "Au": 0.890, "Hg": 1.007,
                        "Tl": 0.589, "Pb": 0.716, "Bi": 0.703, "Po": 0.812, "At": 0,
                        "Rn": 1.037, "Fr": 0.393, "Ra": 0.509, "Ac": 0.499, "Th": 0,
                        "Pa": 0, "U": 0, "Np": 0, "Pu": 0, "Am": 0,
                        "Cm": 0, "Bk": 0, "Cf": 0, "Es": 0, "Fm": 0,
                        "Md": 0, "No": 0, "Lr": 0, "Rf": 0, "Db": 0,
                        "Sg": 0, "Bh": 0, "Hs": 0, "Mt": 0, "Ds": 0,
                        "Rg": 0, "Cn": 0, "Nh": 0, "Fl": 0, "Mc": 0,
                        "Lv": 0, "Ts": 0, "Og": 0, "*": 999}
        self.atom_electron_affinity = {"H": 0.754, "He": -0.22, "Li": 0.62, "Be": -2.5, "B": 0.24, 
                        "C": 1.27, "N": 0.000, "O": 1.465, "F": 3.34, "Ne": -0.30,
                        "Na": 0.55, "Mg": -2.4, "Al": 0.46, "Si": 1.24, "P": 0.77,
                        "S": 2.08, "Cl": 3.61, "Ar": -0.36, "K": 0.50, "Ca": -1.62,
                        "Sc": -0.018, "Ti": -0.006, "V": -0.051, "Cr": -0.064, "Mn": 0,
                        "Fe": 0, "Co": 0, "Ni": 0, "Cu": 0, "Zn": 0,
                        "Ga": 0.37, "Ge": 1.20, "As": 0.81, "Se": 2.02, "Br": 3.36,
                        "Kr": -0.4, "Rb": 0.49, "Sr": -1.74, "Y": 0, "Zr": 0,
                        "Nb":0, "Mo": 0, "Tc": 0, "Ru": 0, "Rh": 0,
                        "Pd": 0, "Ag": 0, "Cd": 0, "In": 0.35, "Sn": 1.25,
                        "Sb": 1.07, "Te": 1.97, "I": 3.06, "Xe": -0.42, "Cs": 0,
                        "Ba": 0, "La": 0, "Ce": 0, "Pr": 0, "Nd": 0,
                        "Pm": 0, "Sm": 0, "Eu": 0, "Gd": 0, "Tb": 0,
                        "Dy": 0, "Ho": 0, "Er": 0, "Tm": 0, "Yb": 0,
                        "Lu": 0, "Hf": 0, "Ta": 0, "W": 0, "Re": 0,
                        "Os": 0, "Ir": 0, "Pt": 0, "Au": 0, "Hg": 0,
                        "Tl": 0, "Pb": 0, "Bi": 0, "Po": 0, "At": 0,
                        "Rn": 0, "Fr": 0, "Ra": 0, "Ac": 0, "Th": 0,
                        "Pa": 0, "U": 0, "Np": 0, "Pu": 0, "Am": 0,
                        "Cm": 0, "Bk": 0, "Cf": 0, "Es": 0, "Fm": 0,
                        "Md": 0, "No": 0, "Lr": 0, "Rf": 0, "Db": 0,
                        "Sg": 0, "Bh": 0, "Hs": 0, "Mt": 0, "Ds": 0,
                        "Rg": 0, "Cn": 0, "Nh": 0, "Fl": 0, "Mc": 0,
                        "Lv": 0, "Ts": 0, "Og": 0, "*": 999}

        self.OUTPUT_INDEX = 1

        self.EARLY_STOP_THRESHOLD = 0.9

    def get_chemical_symbol(self, cs):
        val = math.floor(cs / self._atom_num_upper)
        atomic_number = cs - val * self._atom_num_upper
        atom = [a for a in self.atomic_number.keys() if self.atomic_number[a] == atomic_number]
        return f"{atom[0]}{val}"


CONST = Constants()











